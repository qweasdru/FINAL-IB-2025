# Writeup

Разделим решение задания на две логические части.

## Небо

Запускаем скрипт. В консоли начинают появляться лорные сообщения. 

Запускаем в другой вкладке терминала команду `tcpdump -i any`

Замечаем, что появилось много подозрительных периодических icmp-запросов на фиксированный адрес (меняется после перезапуска скрипта). 

Соединяем этот факт с лорными сообщениями от скрипта в терминале (I'm waiting for your awakening, my dear Prince...). Вывод: нам надо "притвориться" принцем.

Для этого используем команду `ip addr add <address and mask> dev <interface>`.

Вывод в консоли от скрипта меняется на: "My sweet Prince, why do you not respond? I call out to you through the void of infinity, but in response, there is only silence...".

Это значит, что нам нужно как-то начать слушать на адресе, который мы добавили на физический интерфейс.

Используем команду: `nc -l <address> -p 80` (80 - стандартный HTTP порт, ни у кого не должно возникнуть с этим проблем).

Получаем первую часть флага: `flag{my_sw3et_pr1nc3`

## Земля

На моменте, когда мы "притворились" принцем, мы могли заметить в консоли сообщение следующего характера: "Oh, my dear Prince, I have hidden my gift for you in the shadow of your palace, where only time and the wind see it now...". 

Т.е. "Подданный" спрятал для нас где-то в файловой системе "подарок" - вторую часть флага.

Здесь у нас есть два варианта решения задачи:
1. `strace` - и отследить, что конкретно и куда скрипт прячет. Но для этого понадобится преодолеть защиту от отладки PTRACE. 
2. Просто посмотреть, не появилось ли что-то интересного в файловых дескрипторах процесса в этот момент. Узнаём PID процесса через `ps aux | grep <file name>`. Выводим сначала список открытых файловых дескрипторов через `ls /proc/PID/fd`. Выводим все открытые дескрипторы при помощи команды `cat /proc/PID/fd/FD`. В одном из них - вторая часть флага: `_y0u_4r3_th3_0n3}`.

