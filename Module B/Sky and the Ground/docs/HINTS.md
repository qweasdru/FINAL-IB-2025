# Подсказки

## Небо

Шаги:
1. Прослушать основной сетевой интерфейс, увидеть отправляемые скриптом на конечную точку ICMP-пакеты
- Нужно прослушать весь проходящий через сетевые интерфейсы трафик, командой `tcpdump -i any`
- Узнать какой у тебя интерфейс можно командой `ip addr show`
- Нужно обратить внимание на ICMP пакеты. В течение одного сеанса (время жизни скрипта), они отправляются на фиксированный адрес

2. Притвориться конечной точкой
- Чтобы притвориться кем-то в сети, можно просто назначить указанный сетевой адрес на один из физических интерфейсов командой `ip addr add <address and mask> dev <interface>`

3. Запустить прослушку на указанном адресе
- Для этого можно использовать команду `nc -l <addr> -p 80`. Порт 80 - стандартный HTTP порт. В результате, скрипт пришлёт первую часть флага


## Земля

Шаги:
1. Прослушать все действия скрипта в ФС
- Это можно сделать при помощи утилиты strace и других, ей подобных. Но в силу присутствия на скрипте защиты от отладки, придётся обходить его при помощи подгрузки собственной библиотеки черещ `LD_PRELOAD`

2. Получить флаг из файлового дескриптора процесса. 
- Просто читаем `/proc/PID/fd/N`. В одном из ФД - вторая часть флага
- Нюанс: ФД живёт только пока жив скрипт - и создаётся только после "пробуждения" принца.