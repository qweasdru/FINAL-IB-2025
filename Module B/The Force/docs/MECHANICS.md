# Механики

## Картинки 

Для начала, берём бинарный файл самого таска и второй бинарный файл, "соединителя". 

Бинарный файл соединителя прячем внутрь картинки с Дартом Вейдером через конкатенацию. 

Бинарный файл с основной логикой таска разбиваем на 4 равные части. Прячем внутрь четырёх картинок штурмовиков: 2 части через `steghide`, 2 части через конкатенацию.

В оставшийся пятый файл со штурмовиком прячем в exif ключ от бинарного файла (нужно будет ввести при запуске). Ключ перед этим прогоняем через этапы шифровки: plain text -> hex -> base64.

Каждая часть файла с логикой таска имеет уникальную метку в конце, благодаря которой, "соединитель" знает, что это именно наш бинарник, а также знает его порядковый номер в общей структуре.

## Бинарный файл с логикой таска

Логика самого таска защищается отслеживанием отладки. 

Проверяем, не существует ли уже файл с выбранным режимом (анекдоты или пазл). Если существует, но был видоизменён участником, то запускаем хардкорный режим (наказание для читеров).

В противном случае, если существует и всё в порядке - запускаем выбранный режим. Если не существует, то случайным образом выбираем между ними (у "анекдоты" 5% шанс на выпадение).

## Анекдоты 

Просто выводим лорные сообщения и анекдоты. После этого выводим флаг

## Пазл

Запускаем таймер (20 минут для обычных игроков и 10 минут для читеров).

Запускаем периодическую отправку ключей на случайные адреса в локальной сети по UDP соединению. Ловушка: лишь один из ключей - реальный. У настоящего ключа шанс 1/5 на отправку. Ключ отправляется каждые N секунд, где N - значение от 1 до 10, выбираемое случайным образом. 
Фейковые ключи зашифрованы только в base64, настоящие - plain text -> XOR ("DARTHVADER") -> base64. 

Запускаем TCP-сервер, который прослушивает на указанном адресе (адрес участнику предоставляется), и на который необходимо отправить настоящий ключ. После этого, скрипт пропустит нас дальше и выдаст флаг.




