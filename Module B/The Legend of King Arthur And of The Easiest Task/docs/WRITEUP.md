# Writeup

## Этап 1. Анализ pcap

- Среди шума — 13 SIP/RTP взаимодействий.
- Каждый рыцарь передаёт номер своего чанка через RTP — номер указывается как `src_port`.
- Начинает Артур, заканчивает Галахад (`dst = 0.0.0.0`). Параллельно стартует Мордред — его чанк ложный.
- Собираем правильную цепь: следим за порядком передачи и исключаем влияние Мордреда.
- Из UDP-стримов по `src_port` извлекаем 12 валидных чанков + чанк Артура.
- Склеиваем — получаем zip-архив.

## Этап 2. Башня из 15 этажей

### Этажи 0–14

- Каждый уровень: `sacred_scroll.txt` + `graveure_INDEX.jpg` + `next_trial.zip`
- Задания — OSINT-вопросы по «Смерти Артура» (Томас Мэллори) и артуриане.
- Ответ — пароль к следующему архиву.

### Этаж 15

- `graveure_15.jpg` содержит steghide-бонус. Ключ - флаг.
- Основное испытание — `sacred_scroll.txt`, где скрыто сообщение.
- Использован кастомный hex-шифр:
  - Каждые 8 бит делятся на 2 nibble (по 4 бита).
  - Каждому соответствует имя рыцаря.
  - При наличии `MORDRED` — следующий блок инвертируется (`16 - N`).
  - Разделитель: `_EXCALIBUR_`.

## Результат

- Правильно собранный архив + расшифровка финального шифра и бонусного шифра дают флаг и бонусное послание от автора.
